<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Hostel Room Allocation — Demo</title>
  <style>
    :root{--bg:#f4f7fb;--card:#fff;--accent:#0f62fe;--muted:#6b7280}
    body{font-family:Inter, system-ui, -apple-system,Segoe UI, Roboto, 'Helvetica Neue', Arial; margin:0; background:var(--bg); color:#111}
    .wrap{max-width:1100px;margin:28px auto;padding:20px}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px}
    h1{font-size:20px;margin:0}
    .grid{display:grid;grid-template-columns:360px 1fr;gap:18px}
    .card{background:var(--card);border-radius:12px;padding:14px;box-shadow:0 6px 18px rgba(15,22,39,0.06)}
    label{font-size:13px;color:var(--muted);display:block;margin:10px 0 6px}
    input,select{width:100%;padding:8px 10px;border-radius:8px;border:1px solid #e6e9ef;font-size:14px}
    button{background:var(--accent);color:#fff;border:0;padding:10px 12px;border-radius:10px;cursor:pointer}
    .muted{color:var(--muted);font-size:13px}
    .rooms{display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:10px;margin-top:10px}
    .room{padding:10px;border-radius:8px;border:1px solid #eef2ff;display:flex;flex-direction:column;gap:6px}
    .room .title{font-weight:600}
    .room .sub{font-size:13px;color:var(--muted)}
    table{width:100%;border-collapse:collapse;margin-top:12px}
    th,td{padding:8px 10px;text-align:left;border-bottom:1px solid #f0f2f5}
    th{background:#fbfcff;font-weight:600}
    .controls{display:flex;gap:8px;align-items:center}
    .pill{background:#eef2ff;color:#084298;padding:6px 8px;border-radius:999px;font-size:13px}
    .small{font-size:13px}
    .empty{padding:20px;text-align:center;color:var(--muted)}
    @media (max-width:820px){.grid{grid-template-columns:1fr}header{flex-direction:column;align-items:flex-start;gap:8px}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Hostel Room Allocation — Demo</h1>
        <div class="muted">Simple single-file UI for allocating rooms to students</div>
      </div>
      <div class="controls">
        <div class="pill" id="summary">0 allocated • 0 free</div>
      </div>
    </header>

    <div class="grid">
      <aside class="card">
        <h3 style="margin-top:0">Allocate / Search</h3>
        <form id="allocForm" onsubmit="return false;">
          <label for="name">Student name</label>
          <input id="name" placeholder="e.g. Ravi Kumar" required />

          <label for="roll">Roll number</label>
          <input id="roll" placeholder="e.g. 20CS101" required />

          <label for="gender">Gender</label>
          <select id="gender">
            <option value="male">Male</option>
            <option value="female">Female</option>
            <option value="other">Other</option>
          </select>

          <label for="block">Block</label>
          <select id="block">
            <option value="A">A</option>
            <option value="B">B</option>
            <option value="C">C</option>
          </select>

          <label for="roomType">Room type</label>
          <select id="roomType">
            <option value="single">Single</option>
            <option value="double">Double</option>
            <option value="triple">Triple</option>
          </select>

          <div style="display:flex;gap:8px;margin-top:12px">
            <button id="assignBtn">Assign Room</button>
            <button id="clearBtn" type="button" style="background:#f3f4f6;color:#111">Clear</button>
          </div>

          <hr style="margin:12px 0" />

          <label for="search">Search / Filter</label>
          <input id="search" placeholder="Search name, roll or block" />
          <div style="display:flex;gap:8px;margin-top:8px">
            <button id="filterBtn" type="button" style="background:#0b6623">Filter by Block</button>
            <button id="resetFilter" type="button" style="background:#6b7280">Reset</button>
          </div>
        </form>

        <h4 style="margin:12px 0 6px">Rooms overview</h4>
        <div class="rooms" id="roomsView">
          <!-- rooms injected by JS -->
        </div>
      </aside>

      <main>
        <div class="card">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <h3 style="margin:0">Allocations</h3>
            <div class="small muted">Live demo data — click a row to unassign</div>
          </div>

          <table id="allocTable">
            <thead>
              <tr><th>#</th><th>Student</th><th>Roll</th><th>Block</th><th>Room</th><th>Type</th></tr>
            </thead>
            <tbody>
              <!-- rows injected -->
            </tbody>
          </table>

          <div id="emptyState" class="empty" style="display:none">No allocations yet — use the form to assign a room.</div>
        </div>

        <div style="height:14px"></div>

        <div class="card small">
          <strong>Notes</strong>
          <ul>
            <li>Click a table row to unassign the student.</li>
            <li>Room availability is simulated — adapt logic to connect to your backend.</li>
          </ul>
        </div>
      </main>
    </div>
  </div>

  <script>
    // Sample room inventory (block -> rooms)
    const inventory = {
      A: [ {no: 'A101', type:'single'}, {no:'A102', type:'double'}, {no:'A103', type:'double'} ],
      B: [ {no: 'B201', type:'single'}, {no:'B202', type:'triple'}, {no:'B203', type:'double'} ],
      C: [ {no: 'C301', type:'double'}, {no:'C302', type:'single'} ]
    };

    // allocations = [{name,roll,block,room,type,ts}]
    let allocations = [];

    // helpers
    const $ = id => document.getElementById(id);

    function renderRooms(filterBlock = null){
      const container = $('roomsView'); container.innerHTML = '';
      Object.keys(inventory).forEach(block => {
        if(filterBlock && filterBlock !== block) return;
        inventory[block].forEach(room => {
          const taken = allocations.some(a => a.room === room.no);
          const div = document.createElement('div'); div.className='room';
          div.innerHTML = `<div class="title">${room.no}</div><div class="sub">Block ${block} • ${room.type}</div><div class="sub">${taken? 'Occupied' : 'Available'}</div>`;
          container.appendChild(div);
        })
      })
    }

    function renderTable(filterText=''){
      const tbody = $('allocTable').querySelector('tbody'); tbody.innerHTML='';
      const rows = allocations.filter(a => {
        const s = (a.name + ' ' + a.roll + ' ' + a.block).toLowerCase();
        return s.includes(filterText.toLowerCase());
      });

      if(rows.length===0){ $('emptyState').style.display = 'block'; $('allocTable').style.display='none'; }
      else{ $('emptyState').style.display='none'; $('allocTable').style.display='table'; }

      rows.forEach((a,i)=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${i+1}</td><td>${a.name}</td><td>${a.roll}</td><td>${a.block}</td><td>${a.room}</td><td>${a.type}</td>`;
        tr.style.cursor = 'pointer';
        tr.title = 'Click to unassign';
        tr.addEventListener('click', ()=>{ if(confirm('Unassign '+a.name+' from '+a.room+'?')){ allocations = allocations.filter(x => x !== a); updateAll(); } });
        tbody.appendChild(tr);
      })
    }

    function updateSummary(){
      const totalRooms = Object.values(inventory).flat().length;
      const allocated = allocations.length;
      $('summary').textContent = `${allocated} allocated • ${totalRooms - allocated} free`;
    }

    function findFirstAvailable(block, type){
      const list = inventory[block] || [];
      for(const r of list){ if(r.type === type && !allocations.some(a=>a.room===r.no)) return r.no; }
      return null;
    }

    function assign(){
      const name = $('name').value.trim();
      const roll = $('roll').value.trim();
      const gender = $('gender').value;
      const block = $('block').value;
      const type = $('roomType').value;
      if(!name || !roll){ alert('Enter name and roll'); return; }
      const roomNo = findFirstAvailable(block,type);
      if(!roomNo){ alert('No available '+type+' rooms in block '+block); return; }
      allocations.push({name,roll,gender,block,room:roomNo,type,ts:Date.now()});
      // clear name & roll for convenience
      $('name').value=''; $('roll').value='';
      updateAll();
    }

    function updateAll(){ renderRooms(); renderTable($('search').value); updateSummary(); }

    // initial demo data
    allocations.push({name:'Anita S',roll:'21CS211',gender:'female',block:'A',room:'A101',type:'single',ts:Date.now()});
    allocations.push({name:'Ramesh K',roll:'20ME120',gender:'male',block:'B',room:'B202',type:'triple',ts:Date.now()});

    // wire up
    $('assignBtn').addEventListener('click', assign);
    $('clearBtn').addEventListener('click', ()=>{ $('name').value=''; $('roll').value=''; });
    $('search').addEventListener('input', ()=> renderTable($('search').value));
    $('filterBtn').addEventListener('click', ()=>{
      const b = prompt('Enter block to filter (A, B, C)'); if(!b) return; renderRooms(b.toUpperCase());
    });
    $('resetFilter').addEventListener('click', ()=> renderRooms());

    // initial render
    updateAll();
  </script>
</body>
</html>
